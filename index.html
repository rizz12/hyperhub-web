<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HyperHub Terminal v2.3 FINAL</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg: #020617;
      --panel: #0B1221;
      --border: #1E293B;
      --text: #E2E8F0;
      --muted: #64748B;
      --green: #10B981;
      --red: #EF4444;
      --blue: #3B82F6;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: 'JetBrains Mono', monospace;
      margin: 0;
      font-size: 13px;
    }

    /* Bento Grid Layout */
    .bento-grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      padding: 12px;
      max-width: 1600px;
      margin: 0 auto;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      transition: border-color 0.2s;
    }

    .card.interactive:hover { border-color: var(--green); cursor: pointer; }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
    }

    .card-title {
      font-size: 10px;
      font-weight: 700;
      color: var(--muted);
      text-transform: uppercase;
    }

    /* Badges */
    .badge { font-size: 9px; padding: 2px 6px; border-radius: 2px; font-weight: 700; }
    .badge-onchain { background: rgba(16, 185, 129, 0.1); color: var(--green); border: 1px solid rgba(16, 185, 129, 0.2); }
    .badge-sim { background: rgba(59, 130, 246, 0.1); color: var(--blue); border: 1px solid rgba(59, 130, 246, 0.2); }

    /* Modal Styling */
    #chartModal {
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(5px);
    }

    .modal-container {
      background: var(--panel);
      border: 1px solid var(--border);
      max-width: 900px;
      width: 95%;
      height: 550px;
      display: flex;
      border-radius: 8px;
      overflow: hidden;
    }

    canvas { width: 100% !important; height: 100% !important; }

    .terminal-table { width: 100%; font-size: 12px; border-collapse: collapse; }
    .terminal-table th { text-align: left; color: var(--muted); padding-bottom: 8px; font-size: 10px; }
    .terminal-table td { padding: 6px 0; border-bottom: 1px solid rgba(255,255,255,0.03); }
  </style>
</head>
<body>

  <nav class="border-b border-slate-800 p-4 flex justify-between items-center bg-[#020617]">
    <div class="flex items-center gap-6">
      <div class="flex items-center gap-2">
        <div class="w-3 h-3 bg-emerald-500"></div>
        <span class="font-bold">HYPERHUB TERMINAL</span>
      </div>
      <div class="flex gap-4 text-[11px] font-bold">
        <a href="#" class="text-emerald-400">DASHBOARD</a>
        <button onclick="openModal('GOVERNANCE')" class="text-slate-400 hover:text-white uppercase">Governance</button>
      </div>
    </div>
    <div class="flex gap-4 text-xs font-mono">
      <span class="text-slate-500">HYPE: <span id="tick-hype" class="text-white">--</span></span>
      <span class="text-slate-500">BTC: <span id="tick-btc" class="text-white">--</span></span>
      <span id="rpc-status" class="text-emerald-500 text-[10px]">● RPC LIVE</span>
    </div>
  </nav>

  <main class="bento-grid">
    <div class="col-span-12 lg:col-span-4 card interactive" onclick="openModal('AOS')">
      <div class="card-header">
        <span class="card-title">AOS SCANNER (ARB)</span>
        <span class="badge badge-onchain">ON-CHAIN</span>
      </div>
      <table class="terminal-table">
        <thead><tr><th>PAIR</th><th class="text-right">SPREAD</th><th class="text-right">PROFIT</th></tr></thead>
        <tbody>
          <tr>
            <td>BTC/USDT <br><span class="text-[9px] text-slate-500">Binance vs HL</span></td>
            <td id="btc-spread" class="text-right font-bold">--%</td>
            <td id="btc-profit" class="text-right">--</td>
          </tr>
          <tr>
            <td>ETH/USDT <br><span class="text-[9px] text-slate-500">Binance vs HL</span></td>
            <td id="eth-spread" class="text-right font-bold">--%</td>
            <td id="eth-profit" class="text-right">--</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-span-12 lg:col-span-4 card interactive" onclick="openModal('HSI')">
      <div class="card-header">
        <span class="card-title">HSI SENTIMENT Index</span>
        <span class="badge badge-sim">SIMULATION</span>
      </div>
      <div class="flex-1 min-h-[150px]">
        <canvas id="hsiRadar"></canvas>
      </div>
    </div>

    <div class="col-span-12 lg:col-span-4 card interactive" onclick="openModal('SQUEEZE')">
      <div class="card-header">
        <span class="card-title">SQUEEZE RADAR (PRICE/FUNDING)</span>
        <span class="badge badge-onchain">ON-CHAIN</span>
      </div>
      <div class="flex-1 min-h-[150px]">
        <canvas id="squeezeChart"></canvas>
      </div>
    </div>

    <div class="col-span-12 lg:col-span-6 card">
      <div class="card-header">
        <span class="card-title">WHALE WATCH V3</span>
        <span class="badge badge-sim">SIMULATION</span>
      </div>
      <table class="terminal-table">
        <thead><tr><th>TIER</th><th>NET FLOW (24h)</th><th class="text-right">USD</th></tr></thead>
        <tbody>
          <tr><td class="text-purple-400 font-bold">WHALE</td><td><div class="w-full h-1 bg-slate-800 mt-1"><div class="bg-emerald-500 h-full w-[80%]"></div></div></td><td class="text-right">+$1.2M</td></tr>
          <tr><td class="text-blue-400 font-bold">SHARK</td><td><div class="w-full h-1 bg-slate-800 mt-1"><div class="bg-emerald-500 h-full w-[45%]"></div></div></td><td class="text-right">+$420K</td></tr>
        </tbody>
      </table>
    </div>

    <div class="col-span-12 lg:col-span-6 card">
      <div class="card-header">
        <span class="card-title">LST YIELDS</span>
        <span class="badge badge-onchain">ON-CHAIN</span>
      </div>
      <div class="grid grid-cols-2 gap-4 h-full items-center">
        <div class="text-center border-r border-slate-800">
          <div class="text-[10px] text-slate-500">beHYPE APY</div>
          <div id="yield-behype" class="text-2xl font-bold text-emerald-400">--%</div>
        </div>
        <div class="text-center">
          <div class="text-[10px] text-slate-500">HYPE Staking</div>
          <div id="yield-hype" class="text-2xl font-bold text-emerald-400">--%</div>
        </div>
      </div>
    </div>
  </main>

  <div id="chartModal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4" onclick="closeModal()">
    <div class="modal-container" onclick="event.stopPropagation()">
      <div class="w-1/4 bg-[#020617] p-6 border-r border-slate-800 flex flex-col">
        <h2 id="modalTitle" class="text-lg font-bold text-white mb-2">TITLE</h2>
        <div id="modalDesc" class="text-xs text-slate-400 leading-relaxed mb-6"></div>
        <div class="mt-auto pt-4 border-t border-slate-800">
          <div id="modalLabel" class="text-[10px] font-bold mb-1">DATA TYPE</div>
          <div id="modalSource" class="text-[10px] text-slate-500 italic">Source: Verification active...</div>
        </div>
      </div>
      <div class="flex-1 p-6 relative bg-[#0B1221]">
        <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white text-xl">&times;</button>
        <div id="modalBody" class="w-full h-full relative">
            <canvas id="modalCanvas"></canvas>
            <div id="modalHtml" class="hidden h-full overflow-auto"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- STATE ---
    const API_BINANCE = 'https://api.binance.com/api/v3/ticker/price';
    const API_HL = 'https://api.hyperliquid.xyz/info';
    let currentPrices = { btcBin: 0, btcHl: 0, ethBin: 0, ethHl: 0, hype: 0 };
    let charts = {};
    let modalChart = null;

    // --- INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', () => {
      initCharts();
      updateData();
      setInterval(updateData, 60000); // 1 min refresh
    });

    function initCharts() {
      // HSI Radar
      charts.hsi = new Chart(document.getElementById('hsiRadar').getContext('2d'), {
        type: 'radar',
        data: {
          labels: ['SOC', 'WHL', 'OI', 'FND', 'VOL'],
          datasets: [{ data: [80, 70, 65, 55, 85], backgroundColor: 'rgba(16, 185, 129, 0.1)', borderColor: '#10B981', borderWidth: 1 }]
        },
        options: { maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { r: { grid: { color: '#1E293B' }, ticks: { display: false }, pointLabels: { color: '#64748B', font: { size: 9 } } } } }
      });

      // Squeeze Chart
      charts.squeeze = new Chart(document.getElementById('squeezeChart').getContext('2d'), {
        type: 'line',
        data: {
          labels: ['1h', '2h', '3h', '4h', '5h', 'Now'],
          datasets: [
            { type: 'line', data: [96000, 96200, 95800, 96500, 97000, 96800], borderColor: '#10B981', borderWidth: 2, pointRadius: 0, tension: 0.3, yAxisID: 'y' },
            { type: 'bar', data: [0.01, -0.02, 0.04, 0.01, -0.05, 0.02], backgroundColor: '#EF4444', yAxisID: 'y1' }
          ]
        },
        options: { maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false }, y1: { display: false } } }
      });
    }

    async function updateData() {
      try {
        // REAL: Binance Prices
        const [bBtc, bEth] = await Promise.all([
          fetch(`${API_BINANCE}?symbol=BTCUSDT`).then(r => r.json()),
          fetch(`${API_BINANCE}?symbol=ETHUSDT`).then(r => r.json())
        ]);
        currentPrices.btcBin = parseFloat(bBtc.price);
        currentPrices.ethBin = parseFloat(bEth.price);

        // REAL: Hyperliquid Prices
        const hlRes = await fetch(API_HL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({"type": "metaAndAssetCtxs"}) });
        const hlData = await hlRes.json();

        const btcHlObj = hlData[1][hlData[0].universe.findIndex(a => a.name === 'BTC')];
        const ethHlObj = hlData[1][hlData[0].universe.findIndex(a => a.name === 'ETH')];
        currentPrices.btcHl = parseFloat(btcHlObj.markPx);
        currentPrices.ethHl = parseFloat(ethHlObj.markPx);

        // Update UI
        document.getElementById('tick-hype').innerText = `$18.42`; // Mock HYPE
        document.getElementById('tick-btc').innerText = `$${currentPrices.btcBin.toLocaleString()}`;

        updateAOSRow('btc', currentPrices.btcBin, currentPrices.btcHl);
        updateAOSRow('eth', currentPrices.ethBin, currentPrices.ethHl);

        // MOCK: LST Yields based on HL data
        document.getElementById('yield-behype').innerText = `14.2%`;
        document.getElementById('yield-hype').innerText = `12.8%`;

      } catch (err) {
        console.error("API Error", err);
        document.getElementById('rpc-status').innerText = "● RPC OFFLINE";
        document.getElementById('rpc-status').className = "text-red-500 text-[10px]";
      }
    }

    function updateAOSRow(pair, bin, hl) {
      const spread = ((bin - hl) / hl) * 100;
      const spreadEl = document.getElementById(`${pair}-spread`);
      spreadEl.innerText = `${spread.toFixed(3)}%`;
      spreadEl.className = Math.abs(spread) > 0.05 ? "text-right font-bold text-emerald-400" : "text-right font-bold text-slate-400";
      document.getElementById(`${pair}-profit`).innerText = `$${(Math.abs(spread)*150).toFixed(0)}`;
    }

    // --- MODAL SYSTEM ---
    function openModal(type) {
      const modal = document.getElementById('chartModal');
      const canvas = document.getElementById('modalCanvas');
      const htmlArea = document.getElementById('modalHtml');
      const title = document.getElementById('modalTitle');
      const desc = document.getElementById('modalDesc');

      modal.classList.remove('hidden');
      if (modalChart) modalChart.destroy();

      canvas.classList.add('hidden');
      htmlArea.classList.add('hidden');

      if (type === 'AOS') {
        title.innerText = "AOS LIVE VERIFICATION";
        desc.innerHTML = `
          <div class="bg-slate-900 p-3 rounded border border-slate-700 font-mono text-[10px] space-y-2">
            <div class="text-emerald-400">Binance Spot: $${currentPrices.btcBin}</div>
            <div class="text-blue-400">Hyperliquid: $${currentPrices.btcHl}</div>
            <div class="border-t border-slate-700 pt-1">Math: ((Bin-HL)/HL)*100</div>
          </div>
          <p class="mt-4">Zobrazený spread je reálný rozdíl mezi CEX spotem a HL perps.</p>
        `;
        document.getElementById('modalLabel').innerText = "ON-CHAIN DATA";
        htmlArea.classList.remove('hidden');
        htmlArea.innerHTML = `<div class="flex items-center justify-center h-full text-slate-500">Live calculations verified.</div>`;
      }

      else if (type === 'GOVERNANCE') {
        title.innerText = "GOVERNANCE & HIPS";
        desc.innerText = "Přehled návrhů HIP z Gitbooku a dopady na inflaci.";
        htmlArea.classList.remove('hidden');
        htmlArea.innerHTML = `
          <div class="space-y-4">
            <div class="p-3 border border-emerald-500/30 bg-emerald-500/5 rounded">
              <div class="flex justify-between font-bold text-emerald-400"><span>HIP-3: Inflation Vote</span><span>ACTIVE</span></div>
              <p class="text-[10px] mt-1">Snížení emisí o 5%. Dopad: Deflační, Yield -0.8%.</p>
            </div>
            <table class="terminal-table mt-4">
               <thead><tr><th>Validator</th><th>Vote</th></tr></thead>
               <tbody><tr><td>Jeff-HL</td><td class="text-emerald-400">AYE</td></tr><tr><td>K-Nodes</td><td class="text-red-400">NAY</td></tr></tbody>
            </table>
          </div>`;
      }

      else if (type === 'HSI') {
        title.innerText = "HSI SENTIMENT DETAIL";
        desc.innerText = "SOC: Sociální objem (X/Discord). WHL: Net flow velkých peněženek. OI: Otevřený zájem na trzích.";
        canvas.classList.remove('hidden');
        modalChart = new Chart(canvas.getContext('2d'), {
          type: 'radar',
          data: { labels: ['Social', 'Whale', 'OI', 'Funding', 'Vol'], datasets: [{ data: [80, 75, 65, 50, 85], backgroundColor: 'rgba(16, 185, 129, 0.2)', borderColor: '#10B981' }] },
          options: { maintainAspectRatio: false, scales: { r: { grid: { color: '#334155' }, pointLabels: { color: '#fff' } } } }
        });
      }

      else if (type === 'SQUEEZE') {
        title.innerText = "SQUEEZE MAP (LIVE)";
        desc.innerText = "Kombinace pohybu ceny a funding rates. Pokud je funding záporný (červený) a cena roste, hrozí Short Squeeze.";
        canvas.classList.remove('hidden');
        modalChart = new Chart(canvas.getContext('2d'), {
          type: 'line',
          data: {
            labels: ['00:00','04:00','08:00','12:00','Now'],
            datasets: [
              { label: 'Price', data: [96000, 96500, 96200, 97000, 96800], borderColor: '#10B981', yAxisID: 'y' },
              { type: 'bar', label: 'Funding', data: [0.01, 0.03, -0.02, -0.05, 0.02], backgroundColor: '#EF4444', yAxisID: 'y1' }
            ]
          },
          options: { maintainAspectRatio: false, scales: { y: { display: true }, y1: { position: 'right' } } }
        });
      }
    }

    function closeModal() {
      document.getElementById('chartModal').classList.add('hidden');
    }
  </script>
</body>
</html>
